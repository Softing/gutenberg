<html>
    <head>
	
		<script>
            function getFlashMovieObject(movieName) {
                if (window.document[movieName]){
                    return window.document[movieName];
                }
                if (navigator.appName.indexOf("Microsoft Internet")==-1){
                    if (document.embeds && document.embeds[movieName])
                        return document.embeds[movieName]; 
                }
                else // if (navigator.appName.indexOf("Microsoft Internet")!=-1)
                {
                    return document.getElementById(movieName);
                }
            }
            
            function pageInit() {
				setTimeout("flash1Init()", 300);
				setTimeout("flash3Init()", 300);
            }
		</script>
		
		<script>
            function flash1Init() {
                var flash = getFlashMovieObject("flashMovie1");
                flash.init("flashid", "letter", 0, 0);
                flash.set( ["1/3", "2/3"], ["1/6", "5/6"] );
            }
            function flash1Get() {
                var flash = getFlashMovieObject("flashMovie1");
                flash.get("flash1GetParams");
            }
            function flash1GetParams (id, w, h) {
                alert(id +', '+ w +', '+ h);
            }
        </script>
		
		
		<script>
            function flash3Init() {
                var flash = getFlashMovieObject("flashMovie3");
                flash.init("flash1", "letter", 0, 0);
				flash.setGrid(  
					["3/5", "1/5", "2/5", "9/10" ,"5/10" ], 
					["4/6", "3/6", "2/6", "1/6", "5/6", "7/9", "1/9" ] 
				); 
				flash.setBlocks( [ 
					{ id: "blck1", n:"1/3 вер", x: "0/5", y: "0/6", w: "1/1", h: "1/6" }, 
					{ id: "blck2", n:"1/2 гор", x: "0/5", y: "2/6", w: "2/5", h: "2/6" }, 
					{ id: "blck3", n:"Вствка", x: "1/1", y: "1/1", w: "1/5", h: "1/6" } 
				] );
            }
            
			function flash3Load() {
                var flash = getFlashMovieObject("flashMovie3");
                flash.setBlocks( [ 
					{ id: "blck1", n:"1/3 вер", x: "0/5", y: "0/6", w: "1/1", h: "1/6" }, 
					{ id: "blck2", n:"1/2 гор", x: "0/5", y: "2/6", w: "2/5", h: "2/6" }, 
					{ id: "blck3", n:"Вствка", x: "1/1", y: "1/1", w: "1/5", h: "1/6" } 
				] );
            }
			
			function flash3ClearAll() {
                var flash = getFlashMovieObject("flashMovie3");
                flash.deleteAllBlocks();
            }
			
			function flash3GetBlock(blk) {
                var flash = getFlashMovieObject("flashMovie3");
                flash.getBlock("flash3GetParams");
            }
			
			function flash3GetBlocks() {
                var flash = getFlashMovieObject("flashMovie3");
                flash.getBlocks('flash3GetParams');
            }
			
            function flash3GetParams (id, array) {
                
				var string = '';
				
				for (var c=0;c<array.length;c++) {
					string += '[ ';
						string += array[c].id + ', ';
						string += array[c].x + ', ';
						string += array[c].y + ', ';
						string += array[c].w + ', ';
						string += array[c].h;
					string += ' ], ';
				}
				
				alert(id +', '+ string);
            }
			
			function flash3CreateBlock(blck, name) {
				var flash = getFlashMovieObject("flashMovie3");
				flash.setBlock( blck, name, "0/1", "0/1", "0/1", "0/1" );
			}
			function flash3EditBlock(blck) {
				var flash = getFlashMovieObject("flashMovie3");
				flash.editBlock( blck );
			}
			function flash3MoveBlock(blck) {
				var flash = getFlashMovieObject("flashMovie3");
				flash.moveBlock( blck );
			}
			function flash3DeleteBlock(blck) {
				var flash = getFlashMovieObject("flashMovie3");
				flash.deleteBlock(blck);
			}
			function flash3SelectBlock(blck) {
				var flash = getFlashMovieObject("flashMovie3");
				flash.selectBlock(blck);
			}
			
        </script>
		
	</head>
     <body onload="pageInit();">
		<table>
		<td width="400" valign="top">
		
			<object id="flashMovie1" width="100%" height="100%" type="application/x-shockwave-flash" data="/flash/Grid.swf" id="extflashcmp1100" style="visibility: visible; width: 390px; height: 368px; left: 196px; top: 0px;" class=" x-box-item">
			<param name="allowScriptAccess" value="always">
			<param name="bgcolor" value="#ffffff">
			<param name="wmode" value="opaque">
			<param name="FlashVars" value="YUISwfId=123&YUIBridgeCallback=345">
			</object>

			<hr>
			<button onClick="flash1Get();">Get Value</button>
		</td>
		
		<td width="600" valign="top">
		
			<object id="flashMovie3" width="100%" height="100%" type="application/x-shockwave-flash" data="/flash/Dispose.swf" id="extflashcmp1100" style="visibility: visible; width: 390px; height: 368px; left: 196px; top: 0px;" class=" x-box-item">
			<param name="allowScriptAccess" value="always">
			<param name="bgcolor" value="#ffffff">
			<param name="wmode" value="opaque">
			<param name="FlashVars" value="YUISwfId=123&YUIBridgeCallback=345">
			</object>
					
			<hr>
			<table>
			<tr>
				<td onMouseOver="flash3SelectBlock('blck1')">blck1</td>
				<td>
					<button onClick="flash3GetBlock('blck1');">Get Value</button>
					<button onClick="flash3CreateBlock('blck1', 'block 1');">CreateBlock</button>
					<button onClick="flash3EditBlock('blck1');">EditBlock</button>
					<button onClick="flash3MoveBlock('blck1');">MoveBlock</button>					
					<button onClick="flash3DeleteBlock('blck1');">DeleteBlock</button>
				</td>
			</tr>
			<tr>
				<td onMouseOver="flash3SelectBlock('blck2')">blck2</td>
				<td>
					<button onClick="flash3GetBlock('blck2');">Get Value</button>
					<button onClick="flash3CreateBlock('blck2', 'block 2');">CreateBlock</button>
					<button onClick="flash3EditBlock('blck2');">EditBlock</button>
					<button onClick="flash3MoveBlock('blck2');">MoveBlock</button>
					<button onClick="flash3DeleteBlock('blck2');">DeleteBlock</button>
				</td>
			</tr>
			<tr>
				<td onMouseOver="flash3SelectBlock('blck3')">blck3</td>
				<td>
					<button onClick="flash3GetBlock('blck3');">Get Value</button>
					<button onClick="flash3CreateBlock('blck3', 'block 3');">CreateBlock</button>
					<button onClick="flash3EditBlock('blck3');">EditBlock</button>
					<button onClick="flash3MoveBlock('blck3');">MoveBlock</button>
					<button onClick="flash3DeleteBlock('blck3');">DeleteBlock</button>
				</td>
			</tr>
			<tr>
				<td onMouseOver="flash3SelectBlock('blck4')">blck4</td>
				<td>
					<button onClick="flash3GetBlock('blck4');">Get Value</button>
					<button onClick="flash3CreateBlock('blck4', 'block 4');">CreateBlock</button>
					<button onClick="flash3EditBlock('blck4');">EditBlock</button>
					<button onClick="flash3MoveBlock('blck4');">MoveBlock</button>
					<button onClick="flash3DeleteBlock('blck4');">DeleteBlock</button>
				</td>
			</tr>
			</table>
			<hr>
			<button onClick="flash3Load();">Load</button>
			<button onClick="flash3GetBlocks();">Get Values</button>
			<button onClick="flash3ClearAll();">ClearAll</button>
		</td>
		</table>
		
    </body>
</html>
