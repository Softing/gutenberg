<html>
    <head></head>
     <body onload="pageInit();">
        
         <object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"
                 id="ExternalInterfaceExample" width="380" height="360"
                 codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab">
             <param name="movie" value="Create.swf" />
             <param name="quality" value="high" />
             <param name="bgcolor" value="#f5f5f5" />
             <param name="allowScriptAccess" value="sameDomain" />
             <embed src="Create.swf" quality="high" bgcolor="#f5f5f5"
                 width="380" height="360" name="ExternalInterfaceExample" align="middle"
                 play="true" loop="false" quality="high" allowScriptAccess="sameDomain"
                 type="application/x-shockwave-flash"
                 pluginspage="http://www.macromedia.com/go/getflashplayer">
             </embed>
         </object>
         
        <script>
            
            function getFlashMovieObject(movieName) {
                if (window.document[movieName]){
                    return window.document[movieName];
                }
                if (navigator.appName.indexOf("Microsoft Internet")==-1){
                    if (document.embeds && document.embeds[movieName])
                        return document.embeds[movieName]; 
                }
                else // if (navigator.appName.indexOf("Microsoft Internet")!=-1)
                {
                    return document.getElementById(movieName);
                }
            }
            
            function pageInit() {
                setTimeout("flashInit()", 1000);
            }
            function flashInit() {
                var flash = getFlashMovieObject("ExternalInterfaceExample");
                flash.init("flash1", "letter", 0, 0);
                flash.setGrid(  
					["1/5", "2/5", "3/5", "4/5", "9/10" ], 
					[ "1/6", "2/6", "3/6", "4/6",  "5/6" ] 
				);
            }
            
			function flashLoad() {
                var flash = getFlashMovieObject("ExternalInterfaceExample");
                flash.setBlocks( [ 
					{ id: "blck1", x: "0/5", y: "0/6", w: "1/1", h: "1/6" }, 
					{ id: "blck2", x: "2/5", y: "2/6", w: "2/5", h: "2/6" }
					
					//{ id: "blck3", x: "0/1", y: "0/1", w: "0/1", h: "0/1" }
					//{ id: "blck4", x: "0/1", y: "0/1", w: "0/1", h: "0/1" } 
				] );
            }
			
			function flashClearAll() {
                var flash = getFlashMovieObject("ExternalInterfaceExample");
                flash.deleteAllBlocks();
            }
			
			function flashGetBlock(blk) {
                var flash = getFlashMovieObject("ExternalInterfaceExample");
                flash.getBlock("getParams");
            }
			
			function flashGetBlocks() {
                var flash = getFlashMovieObject("ExternalInterfaceExample");
                flash.getBlocks("getParams");
            }
            function getParams (id, array) {
                
				var string = '';
				
				for (var c=0;c<array.length;c++) {
					string += '[ ';
						string += array[c].id + ', ';
						string += array[c].x + ', ';
						string += array[c].y + ', ';
						string += array[c].w + ', ';
						string += array[c].h;
					string += ' ], ';
				}
				
				alert(id +', '+ string);
            }
			
			function flashCreateBlock(blck) {
				var flash = getFlashMovieObject("ExternalInterfaceExample");
				flash.setBlock( blck, "0/1", "0/1", "0/1", "0/1" );
			}
			function flashEditBlock(blck) {
				var flash = getFlashMovieObject("ExternalInterfaceExample");
				flash.editBlock( blck );
			}
			function flashDeleteBlock(blck) {
				var flash = getFlashMovieObject("ExternalInterfaceExample");
				flash.deleteBlock(blck);
			}
			
			function flashSelectBlock(blck) {
				var flash = getFlashMovieObject("ExternalInterfaceExample");
				flash.selectBlock(blck);
			}
			
        </script>
		<hr>
		<table>
		<tr>
			<td onMouseOver="flashSelectBlock('blck1')">blck1</td>
			<td>
				<button onClick="flashGetBlock('blck1');">Get Value</button>
				<button onClick="flashCreateBlock('blck1');">CreateBlock</button>
				<button onClick="flashEditBlock('blck1');">EditBlock</button>
				<button onClick="flashDeleteBlock('blck1');">DeleteBlock</button>
			</td>
		</tr>
		<tr>
			<td onMouseOver="flashSelectBlock('blck2')">blck2</td>
			<td>
				<button onClick="flashGetBlock('blck2');">Get Value</button>
				<button onClick="flashCreateBlock('blck2');">CreateBlock</button>
				<button onClick="flashEditBlock('blck2');">EditBlock</button>
				<button onClick="flashDeleteBlock('blck2');">DeleteBlock</button>
			</td>
		</tr>
		<tr>
			<td onMouseOver="flashSelectBlock('blck3')">blck3</td>
			<td>
				<button onClick="flashGetBlock('blck3');">Get Value</button>
				<button onClick="flashCreateBlock('blck3');">CreateBlock</button>
				<button onClick="flashEditBlock('blck3');">EditBlock</button>
				<button onClick="flashDeleteBlock('blck3');">DeleteBlock</button>
			</td>
		</tr>
		<tr>
			<td onMouseOver="flashSelectBlock('blck4')">blck4</td>
			<td>
				<button onClick="flashGetBlock('blck4');">Get Value</button>
				<button onClick="flashCreateBlock('blck4');">CreateBlock</button>
				<button onClick="flashEditBlock('blck4');">EditBlock</button>
				<button onClick="flashDeleteBlock('blck4');">DeleteBlock</button>
			</td>
		</tr>
		</table>
		<hr>
		<button onClick="flashLoad();">Load</button>
		<button onClick="flashGetBlocks();">Get Values</button>
		<button onClick="flashClearAll();">ClearAll</button>
    </body>
</html>
